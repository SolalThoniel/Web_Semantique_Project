<!DOCTYPE html>

<html lang="fr">
    <head>
		<title>Comics Search</title>
		<!--<link rel="stylesheet" href="css/resultats.css"> -->
        <meta charset="utf-8" />
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>
    </head > <!-- fin de la 1ère partie : l'entête (les réglages) -->
 
    <body>
        <h1 id = "titre" >Comic Search</h1>
		<!-- <img src="images/poisson.png" /> -->
        <p id = "paragraphe">
            Ici nous avons un moteur de recherche de Comics
        </p> 
		
		<input type="text" id="motCle" name="motCle">
		
		<button onclick = "functionTitre()"> Rechercher </button>
		

		<table id="tableauID" border="1"></table>
		
		
	<script>
		
		function getParameterByName(name, url) {
			if (!url) url = window.location.href;
			name = name.replace(/[\[\]]/g, '\\$&');
			var regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
				results = regex.exec(url);
			if (!results) return null;
			if (!results[2]) return '';
			return decodeURIComponent(results[2].replace(/\+/g, ' '));
		}

		var motCleGet = getParameterByName('motCle');

		document.getElementById("motCle").value = motCleGet;
		
		function functionTitre () {  
			var motsCles = document.getElementById("motCle").value;
			
			console.log(motsCles);
			
			var query = encodeURIComponent(  'Select ?c where{ ?c  rdf:type dbo:Comic.  ?c rdfs:label ?label. Filter(contains(?label, "'+motsCles+'")) }');

			var url = 'http://dbpedia.org/sparql?default-graph-uri=http%3A%2F%2Fdbpedia.org&query='+ query +'&output=json';
			
			$.getJSON(url+"&callback=?", function(resultats) {

				$(resultats.results.bindings).each(function(i) {

			/*	$('#acteur').append("<strong>" + resultats.results.bindings[i].nom.value + "</strong>");

				$('#acteur').append('<br />');

				$('#acteur').append("<img src='" + resultats.results.bindings[i].photo.value + "' />");

				$('#acteur').append('<p>' + resultats.results.bindings[i].description.value + '</p>');    */
				document.getElementById("paragraphe").innerHTML = resultats.results.bindings[i].c.value ;
				str = JSON.stringify(resultats.results.bindings );
				console.log(str);

				});

			});
		}
		
		functionTitre();
		
  	</script>

    </body> <!-- fin de la 2e partie : le corps (la partie visible) -->
</html>

